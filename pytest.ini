[tool:pytest]
# Strict test configuration for pmake-recover
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Coverage requirements - 100% mandatory
addopts = 
    --strict-markers
    --verbose
    -ra
    --cov=.
    --cov-report=term-missing:skip-covered
    --cov-report=html:htmlcov
    --cov-report=xml:coverage.xml
    --cov-report=json
    --cov-fail-under=100
    --cov-branch
    --maxfail=1
    --tb=short
    --color=yes
    --strict-config
    -v

# Markers for test organization
markers =
    unit: Unit tests
    integration: Integration tests
    security: Security tests
    slow: Slow tests (> 1 second)
    requires_file: Tests that require file system access
    encryption: Tests for encryption functionality
    random: Tests for random generation
    cli: Tests for CLI interface
    e2e: End-to-end tests

# Timeout for tests
timeout = 30
timeout_method = thread

# Disable warnings we don't care about
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# Live logging for debugging
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# File logging
log_file = tests.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Minimum Python version
minversion = 3.8

# Ensure consistent test ordering
console_output_style = progress

# Required plugins
required_plugins = 
    pytest-cov
    pytest-timeout

# Test discovery patterns
norecursedirs = .git .tox dist build *.egg venv .venv __pycache__

# Cache directory
cache_dir = .pytest_cache